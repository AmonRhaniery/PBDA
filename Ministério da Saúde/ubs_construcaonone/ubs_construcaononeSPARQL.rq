PREFIX ds: <http://dados.gov.br/dataset/ubs_construcao#> 
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX ibge: <https://metadados.ibge.gov.br/#> 
PREFIX gn: <http://www.geonames.org/ontology#> 
PREFIX j.0: <http://w3c/future-csv-vocab/> 
PREFIX j.1: <file:///Users/amonrhaniery/eclipse-workspace/hierarquiaurbana/input/ubs_construcaonone.csv#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX dcat: <http://www.w3.org/ns/dcat#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
CONSTRUCT {
    ?csv a dcat:Distribution;
        dcat:downloadURL ?downuri;
        dcat:mediaType "text/csv" .

    ?dataset a dcat:Dataset;
        dcat:landingPage ?uri;
        dcat:distribution ?csv ;
        rdfs:label "Número de Unidades Básicas de Saúde em Construção - UBS"@pt;
        rdfs:label "Number of Basic Health Units under construction - UBS"@en;
        rdfs:comment "Cartograma representando as Unidades Básicas de Saúde (UBS) que são a porta de entrada preferencial do Sistema Único de Saúde (SUS). O objetivodesses postos é atender até 80% dos problemas de saúde da população, sem que haja a necessidade de encaminhamento parahospitais.Interpretação: Refere-se ao número de UBS que estão em fase de construção Nível de Agregação: Município Periodicidade de Atualização: Mensal. Método de Cálculo: Número absoluto de UBS em construção"@pt .
    
    ?dsubsconstrucao a rdf:Property;
        rdfs:domain ibge:Cidade ;
        rdfs:label "Número de Unidades Básicas de Saúde em Construção."@pt;
        rdfs:comment "Cartograma representando as Unidades Básicas de Saúde (UBS) que são a porta de entrada preferencial do Sistema Único de Saúde (SUS). O objetivodesses postos é atender até 80% dos problemas de saúde da população, sem que haja a necessidade de encaminhamento parahospitais.Interpretação: Refere-se ao número de UBS que estão em fase de construção Nível de Agregação: Município Periodicidade de Atualização: Mensal. Método de Cálculo: Número absoluto de UBS em construção"@pt ;
        rdfs:range xsd:integer.

     ?city a ibge:Cidade ;
        gn:name ?no_cidade ;
        ds:UBSemConstrucao ?valor .
        
} WHERE {
    ?row j.1:no_cidade ?no_cidade ;
        j.1:valor ?valor.
    BIND(ENCODE_FOR_URI( STR( ?no_cidade ) ) AS ?nome2)
    BIND(URI("http://dados.gov.br/dataset/ubs_construcao")AS ?uri)
    BIND(URI("http://dados.gov.br/dataset/ubs_construcao#csv")AS ?csv)
    BIND(URI("http://i3geo.saude.gov.br/i3geo/ogc.php?service=WFS&version=1.0.0&request=GetFeature&typeName=ubs_construcao&outputFormat=CSV")AS ?downuri)
    BIND(URI("http://dados.gov.br/dataset/ubs_construcao")AS ?dataset)
    BIND(URI(CONCAT("https://cidades.ibge.gov.br/#", STR( ?nome2 )))  AS ?city)
    BIND(URI(CONCAT("http://dados.gov.br/dataset/ubs_construcao#", "UBSemConstrucao"))  AS ?dsubsconstrucao )
}